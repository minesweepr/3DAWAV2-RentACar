<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Rent a Car</title>
        <link rel="stylesheet" href="../css/geral.css">
        <link rel="stylesheet" href="../css/home.css">
        <link rel="stylesheet" href="../css/listaEfiltros.css">
        <script src="https://kit.fontawesome.com/86b61fdc16.js" crossorigin="anonymous"></script>
        <script defer src="../js/pesquisa.js" crossorigin="anonymous"></script>
    </head>
    <body>
        <header class="bgw brdr flxcntr">
            <h1>Rent a Car</h1>
            <section class="bdpesquisa brdr">
                <input type="text" id="pesquisa" placeholder="Pesquise por produtos aqui...">
                <i class="fa-solid fa-magnifying-glass"></i>
            </section>

            <section class="usuarionav">
                <a href="../php/logout.php"><i class="fa-solid fa-right-from-bracket brdr"></i></a>
                <a href="home.html"><i class="fa-solid fa-home brdr"></i></a>
                <i class="fa-solid fa-user"></i>
            </section>
        </header>

        <aside class="flxcntr">
            <section>
                <h2>Maneira fácil de alugar um carro por um preço baixo</h2>
                <p>Fornecendo serviços de aluguel de carros baratos e instalações seguras e confortáveis.</p>
            </section>
            <img src="../img/carros.png">
        </aside>

        <main>
            <form class="filtros flxcntr" action="listar.html" method="get">
                <section class="caixa bgw">
                    <h4><span>◉</span> Retirada</h4>
                    <div>
                        <label>Localização<select>
                            <option value="" disabled selected>Selecione sua cidade</option>
                            <option>Rio de Janeiro</option>
                            <option>São Paulo</option>
                            <option>Bahia</option>
                            <option>Rio Grande do Sul</option>
                        </select></label>

                        <label>Data<input type="date" id="data" class="data"></label>

                        <label>Hora<input type="time" id="hora" class="hora"></label>
                    </div>
                </section>

                <button type="submit"><i class="fa-solid fa-check"></i></button>

                <section class="caixa bgw">
                    <h4><span>◉</span> Devolução</h4>
                    <div>
                        <label>Localização<select>
                            <option value="" disabled selected>Selecione sua cidade</option>
                            <option>Rio de Janeiro</option>
                            <option>São Paulo</option>
                            <option>Bahia</option>
                            <option>Rio Grande do Sul</option>
                        </select></label>

                        <label>Data<input type="date" id="data" class="data"></label>

                        <label>Hora<input type="time" id="hora" class="hora"></label>
                    </div>
                </section>
            </form>

            <article>
                <section class="flxcntr">
                    <h3>Carros Populares</h3>
                    <a href="listar.html">Ver todos</a>
                </section>

                <article class="carros" id="listaCarros">
                    <p>Carregando carros...</p>
                </article>

            </article>

            <button onclick="location.href='listar.html'">Ver mais</button>
        </main>
        <script>
            function carregarCarros(){
            const container=document.getElementById("listaCarros");
            let xmlhttp=new XMLHttpRequest();
            xmlhttp.onreadystatechange=function() {
                if(this.readyState===4){
                    if(this.status===200){
                        try{
                            const carros=JSON.parse(this.responseText);
                            container.innerHTML="";
                        
                            if(!carros.length){
                                container.innerHTML="<p>Não há carros cadastrados.</p>";
                                return;
                            }
                            carros.slice(0, 8).forEach(carro => {
                                const section=document.createElement("section");
                                section.className="carro bgw";
                                section.innerHTML=`
                                    <h4 onclick="location.href='listarUm.html?id=${carro.id_carro}'">${carro.modelo}</h4>
                                    <p>${carro.tipo}</p>
                                    <img src="${carro.imagem}">
                                    <ul class="detalhes flxcntr">
                                      <li><i class="fa-solid fa-gas-pump"></i> ${carro.tanque}L</li>
                                      <li><i class="fa-solid fa-gear"></i> ${carro.cambio}</li>
                                      <li><i class="fa-solid fa-user-group"></i> ${carro.capacidade}</li>
                                    </ul>
                                    <div class="preco flxcntr">
                                      <h4>R$${carro.preco} <span>/dia</span></h4>
                                      <button onclick="location.href='pagamento.html?id=${carro.id_carro}'">Alugue agora</button>
                                    </div>
                                `;
                                container.appendChild(section);
                            });
                        
                        }catch (erro){
                            container.innerHTML = "<p>Erro ao processar os dados.</p>";
                            console.error(erro);
                        }
                    } else container.innerHTML = "<p>Erro ao carregar carros. Código: " + this.status + "</p>";
                }
            };
            xmlhttp.open("GET", "../php/listar_carros.php", true);
            xmlhttp.send();
        }
        carregarCarros();
        </script>
    </body>
</html>